var xtsFramework;!function(C){"use strict";var u;u={optionsPage:function(){function i(t,e,i){var s=!1;if(!t||(t=t.split("tab="))[1]&&(s=t[1]),!s)return 1;s=C('.xts-sections-nav [data-id="'+s+'"]');if(0===s.length)return 1;s.trigger("click"),e&&(i.preventDefault(),e.parent().parent().find(".current").removeClass("current"),e.parent().addClass("current"))}C(".xts-options").each(function(){var i=C(this),s=i.find(".xts-last-tab-input");i.on("click",".xts-sections-nav a",function(t){t.preventDefault();var e=C(this),t=e.data("id");s.val(t),i.find(".xts-fields-section.xts-fields-section").removeClass("xts-active-section").addClass("xts-hidden"),i.find('.xts-fields-section[data-id="'+t+'"]').addClass("xts-active-section").removeClass("xts-hidden"),i.find(".xts-active-nav").removeClass("xts-active-nav"),i.find('a[data-id="'+t+'"]').parent().addClass("xts-active-nav"),e.parent().hasClass("xts-subsection-nav")&&e.parent().parent().parent().addClass("xts-active-nav"),e.parent().hasClass("xts-has-child")&&(t=e.parent().find(".xts-subsection-nav").first().find("> a").data("id"),e.parent().find(".xts-subsection-nav").first().addClass("xts-active-nav"),i.find(".xts-fields-section.xts-fields-section").removeClass("xts-active-section").addClass("xts-hidden"),i.find('.xts-fields-section[data-id="'+t+'"]').addClass("xts-active-section").removeClass("xts-hidden"),s.val(t)),C(document).trigger("xts_section_changed")}),C(document).trigger("xts_section_changed"),i.on("click",".xts-reset-options-btn",function(t){return confirm("All your options will be reset to default values. Continue?")})}),C(".toplevel_page_xtemos_options").parent().find("li a").on("click",function(t){var e=C(this);i(e.attr("href"),e,t)}),C(".xts-options-message").length<=0&&i(window.location.href,!1,!1)},optionsPresetsCheckbox:function(t){var e,i,s,n,a,o=C(".xts-options").find(".xts-fields-to-save"),l=t.parents(".xts-field"),d=t.prop("checked"),t=t.data("name");d?(l.addClass("xts-field-disabled"),e=t,i=o.val().split(","),-1<(e=i.indexOf(e))&&(i.splice(e,1),o.val(i.join(",")))):(l.removeClass("xts-field-disabled"),s=t,n=o.val(),-1<(a=n.split(",")).indexOf(s)||(0==n.length?a=[s]:a.push(s),o.val(a.join(","))))},optionsPresets:function(){var t=C(".xts-options"),e=t.find(".xts-inherit-checkbox-wrapper input"),i=t.find(".xts-presets-wrapper"),s=i.data("current-id"),n=i.find('[name="_wpnonce"]').val(),a=i.data("base-url"),o=i.data("preset-url");function l(t){i.html(C(t).html()),d()}function d(){i.find(".xts-condition-rules .xts-rule").each(function(){var e=C(this);e.find(".xts-rule-value-id").select2({ajax:{url:xtsAdminConfig.ajaxUrl,data:function(t){return{action:"xts_get_entity_ids_action",type:e.find(".xts-rule-type").val(),security:n,name:t.term}},method:"POST",dataType:"json"},theme:"xts",dropdownAutoWidth:!1,width:"resolve"})})}function c(){return i.hasClass("xts-presets-loading")}function r(){i.addClass("xts-presets-loading")}function p(){i.removeClass("xts-presets-loading")}d(),i.on("click",".xts-add-new-preset",function(t){t.preventDefault(),c()||(t=prompt("Enter new preset name","New preset"))&&0!=t.length&&(r(),C.ajax({url:xtsAdminConfig.ajaxUrl,method:"POST",data:{action:"xts_new_preset_action",name:t,preset:s,security:n},dataType:"json",success:function(t){t.ui&&10<t.ui.length&&(window.location=o+t.id),u.hideNotice()},error:function(t){window.location=a,console.log("ajax error",t)},complete:function(){p()}}))}).on("click",".xts-remove-preset-btn",function(t){var e;t.preventDefault(),!c()&&confirm("Are you sure you want to remove this preset?")&&(e=C(this).data("id"),r(),C.ajax({url:xtsAdminConfig.ajaxUrl,method:"POST",data:{action:"xts_remove_preset_action",id:e,preset:s,security:n},dataType:"json",success:function(t){t.ui&&10<t.ui.length&&(e==s?window.location=a:l(t.ui)),u.hideNotice()},error:function(t){window.location=a,console.log("ajax error",t)},complete:function(){p()}}))}).on("submit","form",function(t){t.preventDefault();var e=[];i.find("form").find(".xts-rule").each(function(){e.push({type:C(this).find(".xts-rule-type").val(),comparison:C(this).find(".xts-rule-comparison").val(),post_type:C(this).find(".xts-rule-post-type").val(),taxonomy:C(this).find(".xts-rule-taxonomy").val(),custom:C(this).find(".xts-rule-custom").val(),value_id:C(this).find(".xts-rule-value-id").val()})}),r(),C.ajax({url:xtsAdminConfig.ajaxUrl,method:"POST",data:{action:"xts_save_preset_conditions_action",data:e,preset:s,security:n},dataType:"json",success:function(t){t.ui&&10<t.ui.length&&(l(t.ui),C(".xts-presets-wrapper .xts-presets-response").html('<div class="xts-notice xts-success">'+t.success_msg+"</div>")),u.hideNotice()},error:function(t){C(".xts-presets-wrapper .xts-presets-response").html('<div class="xts-notice xts-error">'+t.error_msg+"</div>")},complete:function(){p()}})}).on("click",".xts-add-preset-rule",function(t){t.preventDefault();t=i.find(".xts-rule-template").clone();t.find(".xts-rule").removeClass("xts-hidden"),i.find(".xts-condition-rules").append(t.html()),d()}).on("click",".xts-remove-preset-rule",function(t){t.preventDefault(),C(this).parent().remove()}).on("change",".xts-rule-type",function(t){var e=C(this),i=e.parents(".xts-rule"),s=i.find(".xts-rule-post-type"),n=i.find(".xts-rule-taxonomy"),a=i.find(".xts-rule-custom"),o=i.find(".xts-rule-value-wrapper");switch(e.val()){case"post_type":s.show(),n.hide(),a.hide(),o.hide();break;case"taxonomy":s.hide(),n.show(),a.hide(),o.hide();break;case"post_id":case"term_id":s.hide(),n.hide(),a.hide(),o.show();break;case"custom":s.hide(),n.hide(),a.show(),o.hide()}}),e.on("change",function(){u.optionsPresetsCheckbox(C(this))})},switcherControl:function(){var t=C(".xts-active-section .xts-switcher-control");t.length<=0||t.each(function(){var t=C(this),e=t.find(".xts-switcher-btn"),i=t.find('input[type="hidden"]');t.hasClass("xts-field-inited")||(e.on("click",function(){e.hasClass("xts-active")?(i.val(0).change(),e.removeClass("xts-active")):(i.val(1).change(),e.addClass("xts-active"))}),t.addClass("xts-field-inited"))})},buttonsControl:function(){var t=C(".xts-active-section .xts-buttons-control");t.length<=0||t.each(function(){var i=C(this),s=i.find('input[type="hidden"]');i.hasClass("xts-field-inited")||(i.on("click",".xts-set-item",function(){var t,e=C(this);e.hasClass("xts-btns-set-active")||(t=e.data("value"),i.find(".xts-btns-set-active").removeClass("xts-btns-set-active"),e.addClass("xts-btns-set-active"),s.val(t).change())}),i.addClass("xts-field-inited"))})},colorControl:function(){var t=C(".xts-active-section .xts-color-control");t.length<=0||t.each(function(){var t=C(this),e=t.find('input[type="text"]');t.hasClass("xts-field-inited")||(e.wpColorPicker(),t.addClass("xts-field-inited"))})},checkboxControl:function(){var t=C(".xts-active-section .xts-checkbox-control");t.length<=0||t.each(function(){var t=C(this).find("input");t.hasClass("xts-field-inited")||(t.change(function(){t.prop("checked")?t.val("on"):t.val("off")}),t.addClass("xts-field-inited"))})},uploadControl:function(e){var t=C(".xts-active-section .xts-upload-control");(t=e?C(".widget-content .xts-upload-control"):t).length<=0||t.each(function(){var t=C(this),i=t.find(".xts-btn-remove"),s=t.find("input.xts-upload-input-url"),n=t.find("input.xts-upload-input-id"),a=t.find(".xts-upload-preview"),o=t.find(".xts-upload-preview-input");t.hasClass("xts-field-inited")&&!e||(t.off("click").on("click",".xts-upload-btn, img",function(t){t.preventDefault();var e=wp.media({title:"Insert file",button:{text:"Use this file"},multiple:!1}).on("select",function(){var t=e.state().get("selection").first().toJSON();n.val(t.id).trigger("change"),s.val(t.url.split(xtsAdminConfig.wpUploadDir.baseurl)[1]),o.val(t.url.split(xtsAdminConfig.wpUploadDir.baseurl)[1]),a.find("img").remove(),a.prepend('<img src="'+t.url+'" />'),i.addClass("xts-active")}).open()}),i.on("click",function(t){t.preventDefault(),1==a.find("img").length?a.find("img").remove():a.find("input").val(""),o.val(""),n.val("").trigger("change"),s.val(""),i.removeClass("xts-active")}),t.addClass("xts-field-inited"))})},uploadListControl:function(e){var t=C(".xts-active-section .xts-upload_list-control");(t=e?C(".widget-content .xts-upload_list-control"):t).length<=0||t.each(function(){var t=C(this),s=t.find("input.xts-upload-input-id"),n=t.find(".xts-upload-preview"),a=t.find(".xts-btn-remove");t.hasClass("xts-field-inited")&&!e||(t.off("click").on("click",".xts-upload-btn, img",function(t){t.preventDefault();var e=wp.media({title:"Insert file",button:{text:"Use this file"},multiple:!0}).on("select",function(){var t=e.state().get("selection"),i=s.val();t.map(function(t){var e;(t=t.toJSON()).id&&(e=(t.sizes&&t.sizes.thumbnail?t.sizes.thumbnail:t).url,i=i?i+","+t.id:t.id,n.append('<div data-attachment_id="'+t.id+'"><img src="'+e+'"><a href="#" class="xts-remove"><span class="dashicons dashicons-dismiss"></span></a></div>'))}),s.val(i).trigger("change"),a.addClass("xts-active")}).open()}),n.on("click",".xts-remove",function(t){t.preventDefault(),C(this).parent().remove();var e="";n.find("div").each(function(){var t=C(this).attr("data-attachment_id");e=e+t+","}),s.val(e).trigger("change"),e||a.removeClass("xts-active")}),a.on("click",function(t){t.preventDefault(),n.empty(),s.val("").trigger("change"),a.removeClass("xts-active")}),t.addClass("xts-field-inited"))})},selectControl:function(t){var i,e=C(".xts-active-section .xts-select.xts-select2:not(.xts-autocomplete)");0<(e=t?C(".widget-content .xts-select.xts-select2:not(.xts-autocomplete)"):e).length&&(i={width:"100%",allowClear:!0,theme:"xts",placeholder:{id:"0",text:"Select"}},e.each(function(){var e=C(this);e.hasClass("xts-field-inited")||(e.attr("multiple")&&(e.on("select2:select",function(t){t=C(t.params.data.element);C(this).append(t),C(this).trigger("change.select2")}),e.parent().find(".xts-select2-all").on("click",function(t){t.preventDefault(),e.select2("destroy").find("option").prop("selected","selected").end().select2(i)}),e.parent().find(".xts-deselect2-all").on("click",function(t){t.preventDefault(),e.select2("destroy").find("option").prop("selected",!1).end().select2(i)})),0<e.parents("#widget-list").length||(e.select2(i),e.addClass("xts-field-inited")))})),C(".xts-active-section .xts-select.xts-select2.xts-autocomplete").each(function(){var t=C(this),e=t.data("type"),i=t.data("value"),s=t.data("search");t.hasClass("xts-field-inited")||(t.select2({theme:"xts",allowClear:!0,placeholder:"Select",dropdownAutoWidth:!1,width:"resolve",ajax:{url:xtsAdminConfig.ajaxUrl,data:function(t){return{action:s,type:e,value:i,params:t}},method:"POST",dataType:"json",delay:250,processResults:function(t){return{results:t}},cache:!0}}),t.addClass("xts-field-inited"))})},backgroundControl:function(){var t=C(".xts-active-section .xts-background-control");t.length<=0||t.each(function(){var t=C(this),i=t.find(".xts-btn-remove"),s=t.find("input.xts-upload-input-url"),n=t.find("input.xts-upload-input-id"),a=t.find(".xts-upload-preview"),e=t.find('.xts-bg-color input[type="text"]'),o=t.find(".xts-bg-preview"),l=t.find(".xts-bg-repeat"),d=t.find(".xts-bg-size"),c=t.find(".xts-bg-attachment"),r=t.find(".xts-bg-position"),p=t.find(".xts-bg-image-options"),u=t.find(".xts-bg-position-custom"),f=t.find(".xts-bg-position-custom .xts-position-x input"),h=t.find(".xts-bg-position-custom .xts-position-y input"),x={};function v(){x.backgroundColor=e.val(),x.backgroundImage="url("+xtsAdminConfig.wpUploadDir.baseurl+s.val()+")",x.backgroundRepeat=l.val(),x.backgroundSize=d.val(),x.backgroundAttachment=c.val(),"custom"===r.val()?x.backgroundPosition=f.val()+"px "+h.val()+"px":x.backgroundPosition=r.val(),x.height=100,x.backgroundColor||s.val()?o.css(x).show():o.hide()}t.hasClass("xts-field-inited")||(e.wpColorPicker({change:function(){v()},clear:function(){v()}}),t.find("select").select2({allowClear:!0,theme:"xts",dropdownAutoWidth:!1,width:"resolve"}),t.on("click",".xts-upload-btn, img",function(t){t.preventDefault();var e=wp.media({title:"Insert image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){var t=e.state().get("selection").first().toJSON();s.val(t.url.split(xtsAdminConfig.wpUploadDir.baseurl)[1]),n.val(t.id),a.find("img").remove(),a.prepend('<img src="'+t.url+'" />'),i.addClass("xts-active"),p.addClass("xts-active"),v()}).open()}),i.on("click",function(t){t.preventDefault(),a.find("img").remove(),n.val(""),s.val(""),p.removeClass("xts-active"),i.removeClass("xts-active"),v()}),t.on("change","select, .xts-position-x input, .xts-position-y input",function(){v(),"custom"===r.val()?u.addClass("xts-active"):u.removeClass("xts-active")}),t.addClass("xts-field-inited"))})},customFontsControl:function(){var t=C(".xts-active-section .xts-custom-fonts");t.length<=0||t.each(function(){var s=C(this);s.hasClass("xts-field-inited")||(s.on("click",".xts-custom-fonts-btn-add",function(t){t.preventDefault();var e=s.find(".xts-custom-fonts-template").clone(),i=s.data("key")+1;s.find(".xts-custom-fonts-sections").append(e);t=/{{index}}/gi;e.removeClass("xts-custom-fonts-template hide").html(e.html().replace(t,i)).attr("data-id",e.attr("data-id").replace(t,i)),s.data("key",i),u.uploadControl(!1)}),s.on("click",".xts-custom-fonts-btn-remove",function(t){t.preventDefault(),C(this).parent().parent().remove()}),s.addClass("xts-field-inited"))})},typographyControl:function(){var v,m,g,p,t=C(".xts-active-section .xts-advanced-typography-field");function n(t,e){var i=t.find('[data-id="'+e+'"]'),s=i.find(".xts-typography-family"),n=i.find(".xts-typography-family-input"),a=i.find(".xts-typography-google-input"),o=i.find(".xts-typography-custom-input"),l=i.find(".xts-typography-custom-selector"),d=i.find(".xts-typography-selector"),c=i.find(".xts-typography-transform"),r=i.find(".xts-typography-color"),p=i.find(".xts-typography-color-hover"),t=i.find(".xts-typography-color-active"),e=i.find(".xts-typography-responsive-controls");""!==s.data("value")&&s.val(s.data("value")),b(i,!0,!1),i.find(".xts-typography-family, .xts-typography-style, .xts-typography-subset").on("change",function(){b(i,!1,!1)});var u=[{id:"",text:""}],f={text:"Custom fonts",children:[]},h={text:"Standard fonts",children:[]},x={text:"Google fonts",children:[]};C.map(xtsTypography.stdfonts,function(t,e){h.children.push({id:e,text:t,selected:e==s.data("value")})}),C.map(xtsTypography.googlefonts,function(t,e){x.children.push({id:e,text:e,google:!0,selected:e==s.data("value")})}),C.map(xtsTypography.customFonts,function(t,e){f.children.push({id:e,text:e,selected:e==s.data("value")})}),0<f.children.length&&u.push(f),u.push(h),u.push(x),s.on("select change click",function(){s.hasClass("xts-field-inited")||(s.addClass("xts-field-inited"),s.empty(),s.select2({data:u,allowClear:!0,theme:"xts",dropdownAutoWidth:!1,width:"resolve"}).on("select2:selecting",function(t){var e=t.params.args.data,t=e.text;n.attr("value",t),m=e,b(i,!(v=!0),!0)}).on("select2:unselecting",function(t){C(this).one("select2:opening",function(t){t.preventDefault()})}).on("select2:unselect",function(t){n.val(""),a.val("false"),s.val(null).change(),b(i,!1,!0)}),s.select2("open"))}),d.select2(g).on("select2:selecting",function(t){"custom"==t.params.args.data.id&&(o.val(!0),l.removeClass("hide"))}).on("select2:unselect",function(t){console.log(t),"custom"==t.params.data.id&&(o.val(""),l.val("").addClass("hide"))}),c.select2(g),r.wpColorPicker({change:function(t,e){setTimeout(function(){y(i)},5)}}),p.wpColorPicker(),t.wpColorPicker(),e.on("click",".xts-typography-responsive-opener",function(){C(this).parent().find(".xts-typography-control-tablet, .xts-typography-control-mobile").toggleClass("show hide")}).on("change","input",function(){y(i)})}function y(t){var e={familyInput:t.find(".xts-typography-family-input"),weightInput:t.find(".xts-typography-weight-input"),preview:t.find(".xts-typography-preview"),sizeInput:t.find(".xts-typography-size-container .xts-typography-control-desktop input"),heightInput:t.find(".xts-typography-height-container .xts-typography-control-desktop input"),colorInput:t.find(".xts-typography-color")},i=e.sizeInput.val(),s=e.heightInput.val(),n=e.weightInput.val(),a=e.colorInput.val(),t=e.familyInput.val(),s=s||i;e.preview.css("font-weight",n).css("font-family",t+", sans-serif").css("font-size",i+"px").css("line-height",s+"px"),"none"==t||""==t?C(e.preview).parent().hide():C(e.preview).parent().show(),a&&(t="#444444",""!==a&&(a=a.replace("#",""),t=128<=(299*parseInt(a.substr(0,2),16)+587*parseInt(a.substr(2,2),16)+114*parseInt(a.substr(4,2),16))/1e3?"#444444":"#ffffff"),console.log(a),e.preview.css("color","#"+a).css("background-color",t)),e.preview.slideDown()}function b(t,e,i){var s={family:t.find(".xts-typography-family"),familyInput:t.find(".xts-typography-family-input"),style:t.find("select.xts-typography-style"),styleInput:t.find(".xts-typography-style-input"),weightInput:t.find(".xts-typography-weight-input"),subsetInput:t.find(".xts-typography-subset-input"),subset:t.find("select.xts-typography-subset"),googleInput:t.find(".xts-typography-google-input"),preview:t.find(".xts-typography-preview"),sizeInput:t.find(".xts-typography-size-container .xts-typography-control-desktop input"),heightInput:t.find(".xts-typography-height-container .xts-typography-control-desktop input"),colorInput:t.find(".xts-typography-color")},n=(n=s.familyInput.val())||null,a=s.style.val(),o=s.subset.val();!0===v?(c=m.google,s.googleInput.val(c)):c=u.makeBool(s.googleInput.val()),e&&(a=s.style.data("value"),o=s.subset.data("value"),""!==a&&(a=String(a)),o=String(o)),void 0===xtsTypography.googlefonts&&(c=!1);var l,d,c,r="",r=!0===c&&n in xtsTypography.googlefonts?xtsTypography.googlefonts[n]:p;s.subsetInput.val(o),(v||e||i)&&(l='<option value=""></option>',!0===c?(d="",C.each(r.variants,function(t,e){e.id===a||1===u.size(r.variants)?(d=' selected="selected"',a=e.id):d="",l+='<option value="'+e.id+'"'+d+">"+e.name.replace(/\+/g," ")+"</option>"}),s.subset.data("select2")&&s.style.select2("destroy"),s.style.html(l),s.style.select2(g),d="",l='<option value=""></option>',C.each(r.subsets,function(t,e){e.id===o||1===u.size(r.subsets)?(d=' selected="selected"',o=e.id,s.subset.val(o)):d="",l+='<option value="'+e.id+'"'+d+">"+e.name.replace(/\+/g," ")+"</option>"}),s.subset.data("select2")&&s.subset.select2("destroy"),s.subset.html(l),s.subset.select2(g),s.subset.parent().fadeIn("fast")):r&&(C.each(r,function(t,e){t===a||"normal"===t?(d=' selected="selected"',s.style.find(".select2-chosen").text(e)):d="",l+='<option value="'+t+'"'+d+">"+e.replace("+"," ")+"</option>"}),s.subset.data("select2")&&s.style.select2("destroy"),s.style.html(l),s.style.select2(g),s.subset.parent().fadeOut("fast")),s.familyInput.val(n)),0===s.style.find("option[value='"+a+"']").length?(a="",s.style.val("")):"400"===a&&s.style.val(a),-1!==a.indexOf("italic")?(s.preview.css("font-style","italic"),s.styleInput.val("italic"),a=a.replace("italic","")):(s.preview.css("font-style","normal"),s.styleInput.val("")),s.weightInput.val(a),0===s.subset.find("option[value='"+o+"']").length&&(o="",s.subset.val(""),s.subsetInput.val(o)),c&&(i=a,c=o,null!=(n=n)&&"inherit"!=n&&(n=n.replace(/\s+/g,"+"),i&&""!==i&&(n+=":"+i.replace(/\-/g," ")),c&&""!==c&&(n+="&subset="+c),"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[n]}}))),y(t),v=!1}t.length<=0||(g={width:"100%",allowClear:!(v=!(m=[])),theme:"xts"},p={100:"Thin 100",200:"Extra Light 200",300:"Light 300",400:"Normal 400",500:"Medium 500",600:"Semi Bold 600",700:"Bold 700",800:"Extra Bold 800",900:"Black 900","100italic":"Thin 100 Italic","200italic":"Extra Light 200 Italic","300italic":"Light 300 Italic","400italic":"Normal 400 Italic","500italic":"Medium 500 Italic","600italic":"Semi Bold 600 Italic","700italic":"Bold 700 Italic","800italic":"Extra Bold 800 Italic","900italic":"Black 900 Italic"},t.each(function(){var s=C(this);s.hasClass("xts-field-inited")||(s.find(".xts-typography-section:not(.xts-typography-template)").each(function(){var t=C(this).data("id");n(s,t)}),s.on("click",".xts-typography-btn-add",function(t){t.preventDefault();var e=s.find(".xts-typography-template").clone(),i=s.data("key")+1;s.find(".xts-typography-sections").append(e);t=/{{index}}/gi;e.removeClass("xts-typography-template hide").html(e.html().replace(t,i)).attr("data-id",e.attr("data-id").replace(t,i)),s.data("key",i),n(s,e.attr("data-id"))}),s.on("click",".xts-typography-btn-remove",function(t){t.preventDefault(),C(this).parents(".xts-typography-section").remove()}),s.addClass("xts-field-inited"))}))},makeBool:function(t){return"false"!=t&&"0"!=t&&!1!==t&&0!==t&&("true"==t||"1"==t||!0===t||1==t||void 0)},size:function(t){var e,i=0;for(e in t)t.hasOwnProperty(e)&&i++;return i},megaMenu:function(){C(".xts-design select").on("change",function(){var t=C(this).val(),e=C(this).parents("li").find(".xts-block"),i=C(this).parents("li").find(".xts-width"),s=C(this).parents("li").find(".xts-height"),n=C(this).parents("li").find(".xts-dropdown-ajax");"full"===t&&(e.show(),n.show(),i.hide(),s.hide()),"container"===t&&(e.show(),n.show(),i.hide(),s.hide()),"sized"===t&&(e.show(),n.show(),i.show(),s.show()),"default"===t&&(e.hide(),n.hide(),i.hide(),s.hide())}).change(),C(".xts-block select").change(function(){var t=C(this).find("option:selected").data("edit-link");t?C(".edit-block-link").attr("href",t).show():C(".edit-block-link").hide()}),C("ul#menu-to-edit li.menu-item").each(function(){var t=C(this),e=t.find(".field-title-attribute"),t=t.find(".xts-mega-menu-custom-fields");e.after(t),t.show()}),C(".xts-mega-menu-image-wrapper").each(function(){var t=C(this),i=t.find(".xts-mega-menu-image-preview"),e=t.find(".xts-mega-menu-upload"),s=t.find(".xts-mega-menu-remove"),n=t.find("input.xts-mega-menu-image-id");e.on("click",function(t){t.preventDefault();var e=wp.media({title:"Insert image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){var t=e.state().get("selection").first().toJSON();n.val(t.id),i.find("img").remove(),i.prepend('<img src="'+t.url+'" />'),s.addClass("xts-active")}).open()}),s.on("click",function(t){t.preventDefault(),i.find("img").remove(),n.val(""),s.removeClass("xts-active")})})},rangeControl:function(){var t=C(".xts-active-section .xts-range-control");t.length<=0||t.each(function(){var t=C(this),i=t.find(".xts-range-value"),e=t.find(".xts-range-slider"),s=t.find(".xts-range-field-value-text"),n=i.data();t.hasClass("xts-field-inited")||(e.slider({range:"min",value:n.start,min:n.min,max:n.max,step:n.step,slide:function(t,e){i.val(e.value).trigger("change"),s.text(e.value)}}),i.val(e.slider("value")).trigger("change"),s.text(e.slider("value")),t.addClass("xts-field-inited"))})},editorControl:function(){var t=C(".xts-active-section .xts-editor-control");t.length<=0||t.each(function(){var t,e=C(this),i=e.find("textarea"),s=i.data("language");e.hasClass("xts-field-inited")||((t=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{}).codemirror=_.extend({},t.codemirror,{indentUnit:2,tabSize:2,mode:s}),wp.codeEditor.initialize(i,t),e.addClass("xts-field-inited"))})},fieldsDependencies:function(){C(".xts-field[data-dependency]").each(function(){var i=C(this),s=i.data("dependency").split(";");s.forEach(function(t){0!=t.length&&(t=t.split(":"),(t=C(".xts-"+t[0]+"-field")).on("change","input, select",function(t){var e,a;e=i,a=!0,s.forEach(function(t){if(0!=t.length&&0!=a){var e=t.split(":"),i=C(".xts-"+e[0]+"-field").find("input[type=hidden], select").val();switch(e[1]){case"equals":var s=e[2].split(",");a=!1;for(var n=0;n<s.length;n++)i==s[n]&&(a=!0);break;case"not_equals":s=e[2].split(",");a=!0;for(n=0;n<s.length;n++)i==s[n]&&(a=!1)}}}),a?(e.addClass("xts-shown").removeClass("xts-hidden"),e.find(".xts-css-output").val("1")):(e.addClass("xts-hidden").removeClass("xts-shown"),e.find(".xts-css-output").val("0"))}),t.find("input, select").change())})})},settingsSearch:function(){var s,t=C(".xts-options-search"),e=t.find("input");0!==t.length&&(t.find("form").submit(function(t){t.preventDefault()}),(e=e.autocomplete({source:function(e,t){t(xtsAdminConfig.xtsOptions.filter(function(t){return-1!=t.text.search(new RegExp(e.term,"i"))}).slice(0,16))},select:function(t,e){var i=C(".xts-"+e.item.id+"-field");C('.xts-sections-nav a[data-id="'+e.item.section_id+'"]').click(),C(".xts-highlight-field").removeClass("xts-highlight-field"),i.addClass("xts-highlight-field"),setTimeout(function(){s(i)||C("html, body").animate({scrollTop:i.offset().top-200},400)},300)}}).data("ui-autocomplete"))._renderItem=function(t,e){e='<span class="xts-section-icon '+e.icon+'"></span><span class="xts-setting-title">'+e.title+'</span><br><span class="xts-settting-path">'+e.path+"</span>";return C("<li>").append(e).appendTo(t)},e._renderMenu=function(i,t){var s=this;C.each(t,function(t,e){s._renderItemData(i,e)}),C(i).addClass("xts-settings-result")},s=function(t){var e=t.offset().top,i=e+t.outerHeight(),s=C(window).scrollTop(),t=s+C(window).height();return s<i&&e+200<t})},htmlBlockEditLink:function(){C(".xts-html-block-links").each(function(){var t=C(this),i=t.find("select"),s=t.find(".xts-edit-block-link");function e(){var t=i.find("option:selected").val(),e=s.attr("href").split("post=")[0]+"post="+t+"&action=elementor";t&&"0"!==t&&0!==t?s.attr("href",e).show():s.hide()}0<s.length&&(e(),i.change(function(){e()}))})},imageOptimizer:function(){C("body").on("click",".xts-optimize-image",function(t){t.preventDefault();var i=C(this),e=i.data("id"),t=i.data("security");C.ajax({url:xtsAdminConfig.ajaxUrl,method:"POST",data:{action:"xts_optimize_image",id:e,security:t},dataType:"json",success:function(t){var e;t.success?((e=i.parent().parent().find(".xts-optimizer-result")).find(".xts-optimizer-original span").text(t.original_size_text),e.find(".xts-optimizer-saved span").text(t.saved_bytes_text),e.find(".xts-optimizer-optimized span").text(t.optimized_size_text),e.removeClass("hidden")):t.errors&&(i.parent().find(".xts-optimization-error").remove(),i.parent().append('<span class="xts-optimization-error">'+t.errors+"</span>"))},complete:function(t){console.log("complete")},error:function(t){console.log("error")}})})},sizeGuideTableControl:function(){var t;C.fn.editTable&&(t=C(".xts-size-guide-table-field textarea").editTable(),setTimeout(function(){C(".editor-post-publish-button, .editor-post-publish-panel__toggle").on("click",function(){C(".xts-size-guide-table-field textarea").val(t.getJsonData())})}))},additionalVariationImages:function(){C("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){C(".xts-avi-wrapper").each(function(){var e,t=C(this),s=t.find(".xts-avi-list"),n=t.find(".xts-variation-gallery-ids");function a(){t.parents(".woocommerce_variation").eq(0).addClass("variation-needs-update"),C("#variable_product_options").find("input").eq(0).change()}t.find(".xts-avi-add-image").on("click",function(t){t.preventDefault(),e||(e=wp.media.frames.product_gallery=wp.media({states:[new wp.media.controller.Library({filterable:"all",multiple:!0})]})).on("select",function(){var t=e.state().get("selection"),i=n.val();t.map(function(t){var e;(t=t.toJSON()).id&&(e=(t.sizes&&t.sizes.thumbnail?t.sizes.thumbnail:t).url,i=i?i+","+t.id:t.id,s.append('<div class="xts-avi-image" data-attachment_id="'+t.id+'"><img src="'+e+'"><a href="#" class="xts-avi-remove-image xts-remove"><span class="dashicons dashicons-dismiss"></span></a></li>'))}),n.val(i),a()}),e.open()}),void 0!==s.sortable&&s.sortable({items:"div.xts-avi-image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,e){e.item.css("background-color","#f6f6f6")},stop:function(t,e){e.item.removeAttr("style")},update:function(){var e="";s.find("div.xts-avi-image").each(function(){var t=C(this).attr("data-attachment_id");e=e+t+","}),n.val(e),a()}}),C(document).on("click",".xts-avi-remove-image",function(t){t.preventDefault(),C(this).parent().remove();var e="";s.find("div.xts-avi-image").each(function(){var t=C(this).attr("data-attachment_id");e=e+t+","}),n.val(e),a()})})})},responsiveFields:function(){C(".xts-field-responsive-selector").on("click",".xts-responsive-switch",function(){var t=C(this),e=t.parents(".xts-field").data("id").split("_tablet")[0].split("_mobile")[0].split("_mobile_small")[0];C(".xts-"+e+"-field").hide(),C(".xts-"+e+"_tablet-field").hide(),C(".xts-"+e+"_mobile-field").hide(),C(".xts-"+e+"_mobile_small-field").hide(),(t.hasClass("xts-switch-tablet")?C(".xts-"+e+"_tablet-field"):t.hasClass("xts-switch-mobile")?C(".xts-"+e+"_mobile-field"):t.hasClass("xts-switch-mobile_small")?C(".xts-"+e+"_mobile_small-field"):C(".xts-"+e+"-field")).show()}),C(".xts-inherit-checkbox-wrapper input").on("change",function(){var t,e,i,s,n,a,o=C(this).parents(".xts-field"),l=o.data("id").split("_tablet")[0].split("_mobile")[0];(o.hasClass("xts-desktop-field")||o.hasClass("xts-tablet-field")||o.hasClass("xts-mobile-field")||o.hasClass("xts-mobile_small-field"))&&(t=C(".xts-"+l+"_tablet-field"),e=C(".xts-"+l+"_mobile-field"),i=C(".xts-"+l+"_mobile_small-field"),s=C(".xts-"+l+"-field"),n=t.find(".xts-inherit-checkbox-wrapper input"),a=e.find(".xts-inherit-checkbox-wrapper input"),o=i.find(".xts-inherit-checkbox-wrapper input"),l=s.find(".xts-inherit-checkbox-wrapper input"),C(this).prop("checked")?(t.addClass("xts-field-disabled"),e.addClass("xts-field-disabled"),i.addClass("xts-field-disabled"),s.addClass("xts-field-disabled"),n.prop("checked",!0),a.prop("checked",!0),o.prop("checked",!0),l.prop("checked",!0)):(t.removeClass("xts-field-disabled"),e.removeClass("xts-field-disabled"),i.removeClass("xts-field-disabled"),s.removeClass("xts-field-disabled"),n.prop("checked",!1),a.prop("checked",!1),o.prop("checked",!1),l.prop("checked",!1)),u.optionsPresetsCheckbox(n),u.optionsPresetsCheckbox(a),u.optionsPresetsCheckbox(o),u.optionsPresetsCheckbox(l))})},presetsActive:function(){function i(){C(".xts-sections-nav li").each(function(){var t=C(this),e=t.find("a").data("id");C('.xts-fields-section[data-id="'+e+'"]').find(".xts-inherit-checkbox-wrapper input").each(function(){C(this).prop("checked")||t.addClass("xts-not-inherit")})})}function s(){C(".xts-sections-nav .xts-has-child").each(function(){var t=!1;(t=0<C(this).find(".xts-not-inherit").length?!0:t)?C(this).addClass("xts-not-inherit"):C(this).removeClass("xts-not-inherit")})}i(),s(),C(".xts-inherit-checkbox-wrapper input").on("change",function(){var t=C(this).parents(".xts-fields-section").data("id"),e=!1;C(this).parents(".xts-fields-section").find(".xts-inherit-checkbox-wrapper input").each(function(){C(this).prop("checked")||(e=!0)}),e?C('.xts-sections-nav li a[data-id="'+t+'"]').parent().addClass("xts-not-inherit"):C('.xts-sections-nav li a[data-id="'+t+'"]').parent().removeClass("xts-not-inherit"),s(),i()})},hideNotice:function(){var t=C(".xts-notice:not(.xts-info)");t.each(function(){var t=C(this);setTimeout(function(){t.addClass("xts-hidden")},1e4)}),t.on("click",function(){C(this).addClass("xts-hidden")})},textAreaControl:function(){var n=C(".xts-active-section .xts-textarea-wysiwyg");n.length<=0||n.each(function(){var s,t=C(this),e=t.attr("id"),i=wp.editor.getDefaultSettings();t.hasClass("xts-field-inited")||(i.tinymce.selector="#"+e,i.tinymce.branding=!1,i.tinymce.toolbar="mybutton",i.tinymce.paste_text_sticky=!0,i.tinymce.menubar=!1,i.tinymce.force_br_newlines=!1,i.tinymce.force_p_newlines=!1,i.tinymce.forced_root_block="",i.tinymce.plugins="charmap,colorpicker,hr,lists,media,paste,tabfocus,textcolor,fullscreen,wordpress,wpautoresize,wpeditimage,wpemoji,wpgallery,wplink,wpdialogs,wptextpattern,wpview",i.tinymce.toolbar1="formatselect,bold,italic,bullist,numlist,blockquote,alignleft,aligncenter,alignright,link,wp_more,spellchecker,fullscreen,wp_adv",i.tinymce.toolbar2="strikethrough,hr,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help",window.tinymce.init(i.tinymce),C(".xts-wysiwyg-buttons button").on("click",function(t){t.preventDefault();var e=C(this),i=e.data("id"),t=e.data("mode");e.siblings().removeClass("xts-btns-set-active"),e.addClass("xts-btns-set-active"),s(i,t)}),s=function(t,e){var i=tinymce.get(t),t=C("#"+t);"visual"===e?(t.attr("aria-hidden",!0),i.show(),window.setUserSetting("editor","tinymce")):"text"===e&&(i.hide(),window.setUserSetting("editor","html"),t.css({display:"",visibility:""}),t.attr("aria-hidden",!1))},n.addClass(t))})},pluginActivation:function(){var s=function(s,n){setTimeout(function(){C.ajax({url:xtsAdminConfig.ajaxUrl,method:"POST",data:{action:"xts_check_plugins",xts_plugin:s.data("plugin")},success:function(t){var e,i;"success"===t.status?(e=t.data.required_plugins,i=C(".xts-next-btn"),"has_required"===e?i.addClass("xts-disabled"):i.removeClass("xts-disabled"),e=t.data.is_all_activated,i=C(".xts-plugins"),"yes"===e?i.addClass("xts-all-active"):i.removeClass("xts-all-active")):(u.addNotice(C(".xts-plugin-response"),"warning",t.message),l(s),u.hideNotice()),n(t)}})},1e3)},n=function(e,i){C.ajax({url:xtsPluginsData[e.data("plugin")].activate_url.replaceAll("&amp;","&"),method:"GET",success:function(){s(e,function(t){"success"===t.status&&("activate"===t.data.status?n(e,i):(l(e),d("activate","deactivate",e,t),d("install","deactivate",e,t),d("update","deactivate",e,t),i()))})}})},i=function(e){C.ajax({url:xtsAdminConfig.ajaxUrl,method:"POST",data:{action:"xts_deactivate_plugin",xts_plugin:e.data("plugin")},success:function(t){if("error"===t.status)return u.addNotice(C(".xts-plugin-response"),"warning",t.message),l(e),void u.hideNotice();s(e,function(t){"success"===t.status&&("activate"===t.data.status?(l(e),d("deactivate","activate",e,t)):i(e))})}})};function a(e,i){C.ajax({url:e.attr("href"),method:"POST",success:function(){setTimeout(function(){s(e,function(t){"success"===t.status&&("activate"===t.data.status?n(e,i):(l(e),d("activate","deactivate",e,t),i()))})},1e3)}})}function o(t){t.parents(".xts-plugin-wrapper").addClass("xts-loading"),t.parents(".xts-plugin-wrapper").siblings().addClass("xts-disabled"),C(".xts-ajax-all-plugins").addClass("xts-disabled"),C(".xts-dashboard-box-footer").addClass("xts-disabled"),t.text(xtsAdminConfig[t.data("action")+"_process_plugin_btn_text"])}function l(t){t.parents(".xts-plugin-wrapper").removeClass("xts-loading"),t.parents(".xts-plugin-wrapper").siblings().removeClass("xts-disabled"),C(".xts-ajax-all-plugins").removeClass("xts-disabled"),C(".xts-dashboard-box-footer").removeClass("xts-disabled")}function d(t,e,i,s){s&&s.data.version&&i.parents(".xts-plugin-wrapper").find(".xts-plugin-version").text(s.data.version),i.removeClass("xts-"+t+"-now").addClass("xts-"+e+"-now"),i.attr("href",xtsPluginsData[i.data("plugin")][e+"_url"].replaceAll("&amp;","&")),i.data("action",e),i.text(xtsAdminConfig[e+"_plugin_btn_text"])}C(document).on("click",".xts-ajax-plugin:not(.xts-deactivate-now)",function(t){t.preventDefault();t=C(this);o(t),a(t,function(){})}),C(document).on("click",".xts-deactivate-now",function(t){t.preventDefault();t=C(this);o(t),i(t)}),C(document).on("click",".xts-ajax-all-plugins",function(t){t.preventDefault();var i=[];C(".xts-plugin-wrapper .xts-ajax-plugin:not(.xts-deactivate-now)").each(function(){i.push(C(this))}),function t(){var e;i.length&&(o(e=C(i.shift())),a(e,function(){t()}))}()})},childThemeActivation:function(){C(".xts-install-child-theme").on("click",function(t){t.preventDefault();var e=C(this),i=C(".xts-child-theme-response");e.addClass("xts-loading"),C.ajax({url:xtsAdminConfig.ajaxUrl,method:"POST",data:{action:"xts_install_child_theme"},dataType:"json",success:function(t){e.removeClass("xts-loading"),t&&"success"===t.status?C(".xts-child-step").addClass("xts-installed"):t&&"dir_not_exists"===t.status?u.addNotice(i,"error","The directory can't be created on the server. Please, install the child theme manually or contact our support for help."):u.addNotice(i,"error","The child theme can't be installed. Skip this step and install the child theme manually via Appearance -> Themes.")},error:function(){e.removeClass("xts-loading"),u.addNotice(i,"error","The child theme can't be installed. Skip this step and install the child theme manually via Appearance -> Themes.")}})})},addNotice:function(t,e,i){t.html('<div class="xts-notice xts-'+e+'">'+i+"</div>").fadeIn(),u.hideNotice()},whiteLabel:function(){setTimeout(function(){function t(){C(".theme-overlay .theme-name").text().includes(xtsAdminConfig.theme_slug)?C(".theme-overlay").addClass("xts-space-theme"):C(".theme-overlay").removeClass("xts-space-theme")}C(".theme").on("click",function(){t()}),t()},500)}},xtsFramework={init:function(){C(document).ready(function(){u.hideNotice(),u.megaMenu(),u.pluginActivation(),u.childThemeActivation(),u.whiteLabel(),u.additionalVariationImages(),u.optionsPage(),u.optionsPresets(),u.presetsActive(),u.settingsSearch(),u.responsiveFields(),u.fieldsDependencies(),u.htmlBlockEditLink(),u.sizeGuideTableControl(),u.uploadControl(!0),u.uploadListControl(!0),u.selectControl(!0)}),C(document).on("widget-updated widget-added",function(t,e){u.uploadControl(!0),u.uploadListControl(!0),u.selectControl(!0)}),C(document).on("xts_section_changed",function(){setTimeout(function(){u.typographyControl()}),u.customFontsControl(),u.backgroundControl(),u.switcherControl(),u.buttonsControl(),u.checkboxControl(),u.uploadControl(!1),u.uploadListControl(!1),u.selectControl(!1),u.editorControl(),u.textAreaControl(),u.colorControl(),u.rangeControl()})}}}(jQuery),jQuery(document).ready(function(){xtsFramework.init()});