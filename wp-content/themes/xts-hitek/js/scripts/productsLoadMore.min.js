!function(c){XTSThemeModule.$document.on("xtsProductTabLoaded xtsPjaxComplete",function(){XTSThemeModule.productsLoadMore()}),XTSThemeModule.productsLoadMore=function(){var r=".xts-load-more.xts-type-shop.xts-action-infinite",u=!1;c(".xts-products").each(function(){var s=c(this),i=[],t=s.attr("id"),e=c('.xts-arrows-loader[data-id="'+t+'"]'),d=c('.xts-ajax-arrows[data-id="'+t+'"]');function a(){var t,a,o;d.length<=0||(o=XTSThemeModule.$window.height()/2,t=XTSThemeModule.$window.scrollTop(),a=s.offset().top-o,o=d.find(".xts-prev").outerHeight(),o=s.height()-o,t<a||a+o<t?(d.removeClass("xts-shown"),e.removeClass("xts-shown")):(d.addClass("xts-shown"),e.addClass("xts-shown")))}d.length<=0||(i[1]={items:s.html(),status:"have-posts"},XTSThemeModule.$window.on("scroll",function(){a()}),setTimeout(function(){a()},500),c(".xts-ajax-arrows .xts-prev, .xts-ajax-arrows .xts-next").on("click",function(t){t.preventDefault();var a=c(this);if(!u&&!a.hasClass("xts-disabled")){u=!0,clearInterval(void 0);var o=a.parent().data("id"),s=c("#"+o),e=s.data("source"),t=xts_settings.ajaxurl,o=s.data("atts"),d=s.data("paged"),n=a.parent().find(".xts-next"),r=a.parent().find(".xts-prev");if(d++,a.hasClass("xts-prev")){if(d<2)return;d-=2}e={paged:d,atts:o,action:"xts_get_product_"+e};e.atts.loop=s.find(".xts-col").last().data("loop"),l(t,e,"POST",a,i,d,s,function(t){var a;t.items&&(s.hasClass("xts-masonry-layout")?(a=c(t.items),s.html(a).isotope("appended",a),s.imagesLoaded().progress(function(){s.isotope("layout")})):s.html(t.items),p(),s.data("paged",d)),XTSThemeModule.isMobileSize&&c("html, body").stop().animate({scrollTop:s.offset().top-150},400),1<d?r.removeClass("xts-disabled"):r.addClass("xts-disabled"),"no-more-posts"===t.status?n.addClass("xts-disabled"):n.removeClass("xts-disabled")})}}))}),XTSThemeModule.clickOnScrollButton(r,!1),c(".xts-load-more.xts-type-shop").on("click",function(t){var o,s,e,a,d,n;t.preventDefault(),u||(u=!0,n=(o=c(this)).data("id"),s=c("#"+n),e=s.data("source"),a=xts_settings.ajaxurl,t=s.data("atts"),d=s.data("paged"),n="POST",d++,o.addClass("xts-loading"),t={paged:d,atts:t,action:"xts_get_product_"+e},"main_loop"===e?(a=o.attr("href"),n="GET",t={loop:s.find(".xts-col").last().data("loop")}):t.atts.loop=s.find(".xts-col").last().data("loop"),l(a,t,n,o,[],d,s,function(t){var a;t.items&&(s.hasClass("xts-masonry-layout")?(a=c(t.items),s.append(a).isotope("appended",a),s.imagesLoaded().progress(function(){s.isotope("layout")})):s.append(t.items),p(),s.imagesLoaded().progress(function(){XTSThemeModule.clickOnScrollButton(r,!0)}),s.data("paged",d),"main_loop"===e&&o.attr("href",t.nextPage)),"no-more-posts"===t.status&&o.remove()}))});var l=function(t,a,o,s,e,d,n,r){if(e[d])return n.addClass("xts-loading"),void setTimeout(function(){r(e[d]),n.removeClass("xts-loading"),u=!1},300);var i=n.attr("id"),l=c('.xts-arrows-loader[data-id="'+i+'"]');l.addClass("xts-loading"),n.addClass("xts-loading"),"GET"===o&&(t=XTSThemeModule.removeURLParameter(t,"loop")),c.ajax({url:t,data:a,dataType:"json",method:o,success:function(t){e[d]=t,r(t),window.history.pushState("","",t.currentPage)},error:function(){console.log("ajax error")},complete:function(){s.removeClass("xts-loading"),l.removeClass("xts-loading"),n.removeClass("xts-loading"),u=!1}})},p=function(){XTSThemeModule.$document.trigger("xtsProductLoadMoreReInit")}},c(document).ready(function(){XTSThemeModule.productsLoadMore()})}(jQuery);